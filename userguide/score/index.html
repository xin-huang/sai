
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://xin-huang.github.io/sai/userguide/score/">
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../outlier/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>Calculate Statistics - sai</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#calculate-statistics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="sai" class="md-header__button md-logo" aria-label="sai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            sai
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Calculate Statistics
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/xin-huang/sai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="sai" class="md-nav__button md-logo" aria-label="sai" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    sai
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/xin-huang/sai" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Calculate Statistics
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Calculate Statistics
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      Input files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    <span class="md-ellipsis">
      Output files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../outlier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract Outliers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Make Plots
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      Input files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    <span class="md-ellipsis">
      Output files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="calculate-statistics">Calculate Statistics</h1>
<p><code>sai</code> provides the <code>score</code> command to calculate the number of uniquely shared sites (U statistic) and the quantile of the allele frequencies in such sites (Q statistic).</p>
<p>To see available options, we can use the following command:</p>
<div class="codehilite"><pre><span></span><code>sai score -h
</code></pre></div>

<p>This will show information for each argument:</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-h, --help</td>
<td>show this help message and exit</td>
</tr>
<tr>
<td>--vcf</td>
<td>Path to the VCF file containing variant data</td>
</tr>
<tr>
<td>--chr-name</td>
<td>Chromosome name to analyze from the VCF file.</td>
</tr>
<tr>
<td>--ref</td>
<td>Path to the file with reference population identifiers.</td>
</tr>
<tr>
<td>--tgt</td>
<td>Path to the file with target population identifiers.</td>
</tr>
<tr>
<td>--src</td>
<td>Path to the file with source population identifiers.</td>
</tr>
<tr>
<td>--win-len</td>
<td>Length of each genomic window in base pairs. Default: 50,000.</td>
</tr>
<tr>
<td>--win-step</td>
<td>Step size in base pairs between consecutive windows. Default: 10,000.</td>
</tr>
<tr>
<td>--anc-alleles</td>
<td>Path to the BED file with ancestral allele information. If ancestral allele information is not provided, filtering will be performed for each variant based on whether the allele frequency of any allele (assuming biallelic) meets the specified condition during the calculation of the statistics. Default: None.</td>
</tr>
<tr>
<td>--w</td>
<td>Frequency threshold for variants in the reference population; only variants with frequencies below this threshold are included in the analysis. Default: 0.01.</td>
</tr>
<tr>
<td>--y</td>
<td>List of allele frequency conditions for the source populations. Each value must be in the form =X, &gt;X, <X, >=X, or &lt;=X (e.g., =0.7, &gt;0.8, &lt;0.1, &gt;=0.5, &lt;=0.2). The number of values must match the number of source populations in the file specified by <code>--src</code>; the order of the allele frequency conditions should also correspond to the order of source populations in that file. Default: =1.</td>
</tr>
<tr>
<td>--output</td>
<td>Output file path for saving results.</td>
</tr>
<tr>
<td>--stat</td>
<td>Type of statistic to compute: UXX or QXX, where XX is a percentage-like index indicating a threshold in the target population. For example, <code>U50</code> means the allele frequency is greater than 0.5, and <code>Q95</code> means the allele frequency is greater than or equal to the 95th percentile among sites meeting the specified conditions.</td>
</tr>
</tbody>
</table>
<h2 id="input-files">Input files</h2>
<p><code>sai</code> requires a biallelic VCF file containing all populations, including the reference population (assumed to have no introgression), the target population (assumed to have received introgressed material), and the source population (assumed to have provided the introgressed material). It also assumes that all variants observed in these populations are already included in the input VCF file. The program does not fill in missing genotypes (e.g., treating unobserved genotypes as homozygous reference, as done in <a href="https://github.com/xzhang-popgen/maladapt/blob/fba58dac6278d1b4cc573c78ab7c56911b4072b0/empirical/1empirical_compute-features.py#L318-L326">MaLAdapt</a>). An example VCF file can be found <a href="https://github.com/xin-huang/sai/blob/main/examples/data/1KG.nea_den.chr9.example.vcf.gz">here</a>.</p>
<p>Three tab-delimited files are required to specify the population information for individuals in the reference, target, and source populations. An example file is shown below and can also be found <a href="https://github.com/xin-huang/sai/blob/main/examples/data/1KG.nea_den.samples.txt">here</a>.</p>
<div class="codehilite"><pre><span></span><code>NEA AltaiNeandertal
DEN Denisova
</code></pre></div>

<p>This file specifies the individuals in the source populations. In this example, there are two source populations, NEA and DEN (first column), and the second column lists the corresponding sample names matching those in the VCF header.</p>
<h2 id="output-files">Output files</h2>
<p>An example output of the U statistic calculation is shown below.</p>
<table>
<thead>
<tr>
<th>Chrom</th>
<th>Start</th>
<th>End</th>
<th>Ref</th>
<th>Tgt</th>
<th>Src</th>
<th>N(Variants)</th>
<th>U50</th>
<th>Candidate</th>
</tr>
</thead>
<tbody>
<tr>
<td>9</td>
<td>16400001</td>
<td>16440000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>1082</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16440001</td>
<td>16480000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>983</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16480001</td>
<td>16520000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>985</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16520001</td>
<td>16560000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>966</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16560001</td>
<td>16600000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>1029</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16600001</td>
<td>16640000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>1063</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16640001</td>
<td>16680000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>1152</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16680001</td>
<td>16720000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>999</td>
<td>1</td>
<td>9:16715657</td>
</tr>
<tr>
<td>9</td>
<td>16720001</td>
<td>16760000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>1007</td>
<td>2</td>
<td>9:16758710,9:16759357</td>
</tr>
<tr>
<td>9</td>
<td>16760001</td>
<td>16800000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>1060</td>
<td>1</td>
<td>9:16770229</td>
</tr>
<tr>
<td>9</td>
<td>16800001</td>
<td>16840000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>960</td>
<td>1</td>
<td>9:16800789</td>
</tr>
<tr>
<td>9</td>
<td>16840001</td>
<td>16880000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>923</td>
<td>0</td>
<td>NA</td>
</tr>
<tr>
<td>9</td>
<td>16880001</td>
<td>16920000</td>
<td>AFR+EAS</td>
<td>EUR</td>
<td>NEA,DEN</td>
<td>512</td>
<td>0</td>
<td>NA</td>
</tr>
</tbody>
</table>
<p>Each row in the output file corresponds to a genomic window, summarizing the result for that region. The columns are as follows:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chrom</td>
<td>Chromosome number where the window is located.</td>
</tr>
<tr>
<td>Start</td>
<td>Start position (1-based, inclusive) of the window.</td>
</tr>
<tr>
<td>End</td>
<td>End position (inclusive) of the window.</td>
</tr>
<tr>
<td>Ref</td>
<td>Reference population.</td>
</tr>
<tr>
<td>Tgt</td>
<td>Target population.</td>
</tr>
<tr>
<td>Src</td>
<td>Source population.</td>
</tr>
<tr>
<td>N(Variants)</td>
<td>Number of variants found in this genomic window. Sites with missing genotypes in any population are excluded. If ancestral allele information is provided, variants whose ancestral allele differ from both the reference and alternative allele in the VCF file are also excluded.</td>
</tr>
<tr>
<td>UXX or QXX</td>
<td>Number of uniquely shared sites or the quantile statistic in this window.</td>
</tr>
<tr>
<td>Candidate</td>
<td>Variant(s) (<code>chrom:pos</code>) that meet the specified condition. For the U statistic, this refers to variant(s) whose allele frequency in the reference population is below a specified threshold, allele frequency in the target population exceeds a specified threshold, and allele frequency in the source population meets a defined condition (e.g., fixed). For the Q statistic, this refers to variant(s) that satisfy the following three conditions: (1) the allele frequency in the reference population is below a specified threshold; (2) the allele frequency in the source population meets a defined condition (e.g., fixed); and (3) among all variants meeting (1) and (2), the allele frequency in the target population is greater than or equal to a specified percentile (e.g., the 95th percentile) within this subset of variants in the window.</td>
</tr>
</tbody>
</table>
<h2 id="examples">Examples</h2>
<p>The following example estimates the U statistic using biallelic single nucleotide polymorphisms (SNPs) in the region <code>chr9:16400001-16900000</code> from <a href="https://ftp.ncbi.nih.gov/1000genomes/ftp/release/20130502/">the 1000 Genomes Project</a>. The Neanderthal genome was obtained from <a href="http://cdna.eva.mpg.de/neandertal/Vindija/VCF/Altai/">here</a>, and the Denisovan genome from <a href="http://cdna.eva.mpg.de/neandertal/Vindija/VCF/Denisova/">here</a>. The reference population includes all African populations (ESN, GWD, LWK, MSL, YRI), excluding the admixed African populations (ACB and ASW), and all East Asian populations (CDX, CHB, CHS, JPT, KHV). The target population consists of all European populations (CEU, FIN, GBR, IBS, TSI). The source populations comprise one Neanderthal individual (AltaiNeandertal) and one Denisovan individual (Denisova).</p>
<p>To detect adaptively introgressed variants from <strong>both Neanderthals and Denisovans</strong>, we can use the following command:</p>
<div class="codehilite"><pre><span></span><code>sai score --vcf examples/data/1KG.nea_den.chr9.example.vcf.gz \
          --ref examples/data/1KG.ref.samples.txt \
          --tgt examples/data/1KG.tgt.samples.txt \
          --src examples/data/1KG.nea_den.samples.txt \
          --anc-alleles examples/data/hg19.chr9.example.anc.alleles.bed \
          --chr-name 9 --stat U50 --w 0.01 --y =1 =1 \
          --win-len 40000 --win-step 40000 \
          --output examples/results/1KG.nea_den.chr9.example.both.U50.scores.tsv
</code></pre></div>

<p>We provide a BED file to specify the ancestral allele for each variant, based on alignments from <a href="https://ftp.ensembl.org/pub/release-75/fasta/ancestral_alleles/">Ensembl</a>.
In this example, the <code>--w</code>, and <code>--y</code> arguments define the filtering conditions: the allele frequency of a variant must be less than 0.01 in the reference population and fixed (<code>=1</code>) in both Neanderthal and Denisovan genomes. The <code>50</code> in <code>--stat U50</code> indicates that the allele frequency must be greater than 0.5 in the target population. The output is shown above and can be found <a href="https://github.com/xin-huang/sai/blob/main/examples/results/1KG.nea_den.chr9.example.both.U50.scores.tsv">here</a>.</p>
<p>To estimate the Q95 statistic for the same data, simply change <code>--stat U50</code> to <code>--stat Q95</code>:</p>
<div class="codehilite"><pre><span></span><code>sai score --vcf examples/data/1KG.nea_den.chr9.example.vcf.gz \
          --ref examples/data/1KG.ref.samples.txt \
          --tgt examples/data/1KG.tgt.samples.txt \
          --src examples/data/1KG.nea_den.samples.txt \
          --anc-alleles examples/data/hg19.chr9.example.anc.alleles.bed \
          --chr-name 9 --stat Q95 --w 0.01 --y =1 =1 \
          --win-len 40000 --win-step 40000 \
          --output examples/results/1KG.nea_den.chr9.example.both.Q95.scores.tsv
</code></pre></div>

<p>The output can be found <a href="https://github.com/xin-huang/sai/blob/main/examples/results/1KG.nea_den.chr9.example.both.Q95.scores.tsv">here</a>.</p>
<p>To detect adaptively introgressed variants from <strong>Neanderthal introgression only</strong>, we can use:</p>
<div class="codehilite"><pre><span></span><code>sai score --vcf examples/data/1KG.nea_den.chr9.example.vcf.gz \
          --ref examples/data/1KG.ref.samples.txt \
          --tgt examples/data/1KG.tgt.samples.txt \
          --src examples/data/1KG.nea_den.samples.txt \
          --anc-alleles examples/data/hg19.chr9.example.anc.alleles.bed \
          --chr-name 9 --stat U50 --w 0.01 --y =1 =0 \
          --win-len 40000 --win-step 40000 \
          --output examples/results/1KG.nea_den.chr9.example.nea.specific.U50.scores.tsv
</code></pre></div>

<p>Here, we set <code>--y =1 =0</code> to require that the variant be fixed in the Neanderthal individual and absent in the Denisovan. This ensures that only Neanderthal-specific variants are considered as potential candidates for introgression. The output can be found <a href="https://github.com/xin-huang/sai/blob/main/examples/results/1KG.nea_den.chr9.example.nea.specific.U50.scores.tsv">here</a>.</p>
<p>To detect adaptively introgressed variants from <strong>Denisovan introgression only</strong>, we can use:</p>
<div class="codehilite"><pre><span></span><code>sai score --vcf examples/data/1KG.nea_den.chr9.example.vcf.gz \
          --ref examples/data/1KG.ref.samples.txt \
          --tgt examples/data/1KG.tgt.samples.txt \
          --src examples/data/1KG.nea_den.samples.txt \
          --anc-alleles examples/data/hg19.chr9.example.anc.alleles.bed \
          --chr-name 9 --stat U50 --w 0.01 --y =0 =1 \
          --win-len 40000 --win-step 40000 \
          --output examples/results/1KG.nea_den.chr9.example.den.specific.U50.scores.tsv
</code></pre></div>

<p>In this case, <code>--y =0 =1</code> requires that the variant be fixed in the Denisovan individual and absent in the Neanderthal, thereby identifying variants potentially introgressed from Denisovans only. The output can be found <a href="https://github.com/xin-huang/sai/blob/main/examples/results/1KG.nea_den.chr9.example.den.specific.U50.scores.tsv">here</a>.</p>
<p>Any number of source populations is supported, including one, two, or more. However, note that the order of values provided to <code>--y</code> must match the order of source populations as specified in the file given by <code>--src</code>. For example, in <code>examples/data/1KG.nea_den.samples.txt</code>, the first source population is Neanderthal and the second is Denisovan. Therefore, <code>--y =1 =0</code> specifies that the variant must be fixed in Neanderthals and absent in Denisovans, while <code>--y =0 =1</code> specifies the reverse.</p>
<p>Providing <code>--y</code> values in the wrong order (e.g., reversing the values without changing the order of the populations in <code>--src</code>) will result in incorrect interpretation of source-specific introgression signals.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>